      rapidityptrawh->Fill(rapidity[i],pt[i]);
      if(pt[i]<0.315 && abs(rapidity[i])>0.95*ybeam && abs(rapidity[i])<1.05*ybeam){      
      if(pt[i]<0.3 && abs(rapidity[i])>0.8*ybeam){
      //      int iybin=rapidity[i]/ddy;
      if(abs(rapidity[i]/ybeam)>0.10)iybin=1*rapidity[i]/abs(rapidity[i]);
      if(abs(rapidity[i]/ybeam)>0.35)iybin=2*rapidity[i]/abs(rapidity[i]);
      if(abs(rapidity[i]/ybeam)>0.60)iybin=3*rapidity[i]/abs(rapidity[i]);
      if(abs(rapidity[i]/ybeam)>0.85)iybin=4*rapidity[i]/abs(rapidity[i]);
      //      cout<<" ddy= "<<ddy<<" y= "<<rapidity[i]<<" iybin= "<<iybin<<endl;
      xvsrapidity_allnucleonsh->Fill(rapidity[i],x[i]);
      if(pt[i]<0.3 && abs(rapidity[i])>0.8*ybeam)continue; // kill spectators
      if(abs(rapidity[i])>0.5*ybeam)continue; // kill particles not in central rapidity
      rapiditypth->Fill(rapidity[i]/ybeam,pt[i]);      
      if(part_id[i]==211)rapiditypt_piph->Fill(rapidity[i]/ybeam,pt[i]);      
      if(part_id[i]==-211)rapiditypt_pimh->Fill(rapidity[i]/ybeam,pt[i]);      
      if(part_id[i]==321)rapiditypt_kph->Fill(rapidity[i]/ybeam,pt[i]);      
      if(part_id[i]==-321)rapiditypt_kmh->Fill(rapidity[i]/ybeam,pt[i]);      
      if(part_id[i]==2212)rapiditypt_prh->Fill(rapidity[i]/ybeam,pt[i]);      
      rapidityext_all_h->Fill(rapidity[i]/ybeam);
      if(part_id[i]==2212 ||part_id[i]==2112)rapidityext_pn_h->Fill(rapidity[i]/ybeam);
      if(part_id[i]==-2212 ||part_id[i]==-2112)rapidityext_pnbar_h->Fill(rapidity[i]/ybeam);
	etarapidityh->Fill(eta[i],rapidity[i]/ybeam);
	rapidityvst_allnh->Fill(rapidity[i]/ybeam,t_last_coll[i]); 
      if(abs(rapidity[i])>0.5*ybeam)continue; // URQMD - really kill spectators
      rapidityh->Fill(rapidity[i]);
      int iybin=rapidity[i]/ddy;
	cth_1_rapidityext_all_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==2212 ||part_id[i]==2112)cth_1_rapidityext_pn_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==-2212 ||part_id[i]==-2112)cth_1_rapidityext_pnbar_h->Fill(rapidity[i]/ybeam,cth1);
      if(eta[i]> etamintpc && eta[i]<etamaxtpc && rapidity[i] > rapiditymincut && rapidity[i] < rapiditymaxcut && pt[i]>ptmincut && pt[i]<ptmaxcut  ){
	cth_1_rapidity_all_h->Fill(rapidity[i]/ybeam,cth1);
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_1_pt_all_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_1_b_all_h->Fill(b_impact*b_impact,cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==211) cth_1_rapidity_pip_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_pip_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_b_pip_h->Fill(b_impact*b_impact,cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==-211) cth_1_rapidity_pim_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_pim_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_b_pim_h->Fill(b_impact*b_impact,cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==321) cth_1_rapidity_kp_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_kp_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_b_kp_h->Fill(b_impact*b_impact,cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==-321) cth_1_rapidity_km_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_km_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_b_km_h->Fill(b_impact*b_impact,cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==2212) cth_1_rapidity_pr_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_pr_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	if(part_id[i]==6201) cth_1_rapidity_deut_h->Fill(rapidity[i]/ybeam,cth1);
	if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_1_pt_deut_h->Fill(pt[i],cth1*eta[i]/abs(eta[i]));
	cth_2_rapidity_all_h->Fill(rapidity[i]/ybeam,cth2);
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_2_pt_all_h->Fill(pt[i],cth2);
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_2_b_all_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==211) cth_2_rapidity_pip_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_pip_h->Fill(pt[i],cth2);
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_pip_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==-211) cth_2_rapidity_pim_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_pim_h->Fill(pt[i],cth2);
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_pim_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==321) cth_2_rapidity_kp_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_kp_h->Fill(pt[i],cth2);
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_kp_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==-321) cth_2_rapidity_km_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_km_h->Fill(pt[i],cth2);
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_km_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==2212) cth_2_rapidity_pr_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_pr_h->Fill(pt[i],cth2);
	if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_pr_h->Fill(b_impact*b_impact,cth2);
	if(part_id[i]==6201) cth_2_rapidity_deut_h->Fill(rapidity[i]/ybeam,cth2);
	if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_pt_deut_h->Fill(pt[i],cth2);
	if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_2_b_deut_h->Fill(b_impact*b_impact,cth2);
	cth_3_rapidity_all_h->Fill(rapidity[i]/ybeam,cth3);
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_pt_all_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_b_all_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==211) cth_3_rapidity_pip_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_pip_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_pip_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==-211) cth_3_rapidity_pim_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_pim_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_pim_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==321) cth_3_rapidity_kp_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_kp_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_kp_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==-321) cth_3_rapidity_km_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_km_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_km_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==2212) cth_3_rapidity_pr_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_pr_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_pr_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==6201) cth_3_rapidity_deut_h->Fill(rapidity[i]/ybeam,cth3);
	if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_deut_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_deut_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    cth_3_rapidity_ptcut1_cent_all_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==211) cth_3_rapidity_ptcut1_cent_pip_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-211) cth_3_rapidity_ptcut1_cent_pim_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==321) cth_3_rapidity_ptcut1_cent_kp_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-321) cth_3_rapidity_ptcut1_cent_km_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212) cth_3_rapidity_ptcut1_cent_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212 && rsq1<rsqmax)eps_x_rapidity_ptcut1_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut1_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut1_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1);
	    if(part_id[i]==2212) cth_3_rapidity_ptcut2_cent_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_x_rapidity_ptcut2_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut2_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut2_cent_pr_h->Fill(rapidity[i]/ybeam,rsq1);
	    if(part_id[i]==6201) cth_3_rapidity_ptcut1_cent_deut_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==6201) cth_3_rapidity_ptcut2_cent_deut_h->Fill(rapidity[i]/ybeam,cth3);
	    cth_3_rapidity_ptcut1_mid_all_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==211) cth_3_rapidity_ptcut1_mid_pip_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-211) cth_3_rapidity_ptcut1_mid_pim_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==321) cth_3_rapidity_ptcut1_mid_kp_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-321) cth_3_rapidity_ptcut1_mid_km_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212) cth_3_rapidity_ptcut1_mid_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_x_rapidity_ptcut1_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut1_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut1_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1); 
	    if(part_id[i]==2212) cth_3_rapidity_ptcut2_mid_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_x_rapidity_ptcut2_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut2_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut2_mid_pr_h->Fill(rapidity[i]/ybeam,rsq1); 
	    if(part_id[i]==6201) cth_3_rapidity_ptcut1_mid_deut_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==6201) cth_3_rapidity_ptcut2_mid_deut_h->Fill(rapidity[i]/ybeam,cth3);
	    cth_3_rapidity_ptcut1_periph_all_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==211) cth_3_rapidity_ptcut1_periph_pip_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-211) cth_3_rapidity_ptcut1_periph_pim_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==321) cth_3_rapidity_ptcut1_periph_kp_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==-321) cth_3_rapidity_ptcut1_periph_km_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212) cth_3_rapidity_ptcut1_periph_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_x_rapidity_ptcut1_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut1_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut1_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1);
	    if(part_id[i]==2212) cth_3_rapidity_ptcut2_periph_pr_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_x_rapidity_ptcut2_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1*cth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)eps_y_rapidity_ptcut2_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1*sth3);
	    if(part_id[i]==2212&& rsq1<rsqmax)rsq_rapidity_ptcut2_periph_pr_h->Fill(rapidity[i]/ybeam,rsq1);
	    if(part_id[i]==6201) cth_3_rapidity_ptcut1_periph_deut_h->Fill(rapidity[i]/ybeam,cth3);
	    if(part_id[i]==6201) cth_3_rapidity_ptcut2_periph_deut_h->Fill(rapidity[i]/ybeam,cth3);
	if(abs(rapidity[i]/ybeam)<ycut1){
	    if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_pt_ycut1_cent_all_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_pip_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_pim_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_kp_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_km_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_pr_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_cent_deut_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)eps_x_pt_ycut1_cent_pr_h->Fill(pt[i],rsq1*cth3*eta[i]/abs(eta[i])); 
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  eps_y_pt_ycut1_cent_pr_h->Fill(pt[i],rsq1*sth3);
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  rsq_pt_ycut1_cent_pr_h->Fill(pt[i],rsq1); 
	    if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_pt_ycut1_mid_all_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_pip_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_pim_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_kp_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_km_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_pr_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_mid_deut_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)eps_x_pt_ycut1_mid_pr_h->Fill(pt[i],rsq1*cth3*eta[i]/abs(eta[i]));  
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  eps_y_pt_ycut1_mid_pr_h->Fill(pt[i],rsq1*sth3);
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  rsq_pt_ycut1_mid_pr_h->Fill(pt[i],rsq1);   
	    if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_pt_ycut1_periph_all_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_pip_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_pim_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_kp_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_km_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_pr_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_pt_ycut1_periph_deut_h->Fill(pt[i],cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)eps_x_pt_ycut1_periph_pr_h->Fill(pt[i],rsq1*cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  eps_y_pt_ycut1_periph_pr_h->Fill(pt[i],rsq1*sth3);
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  rsq_pt_ycut1_periph_pr_h->Fill(pt[i],rsq1);
	if(abs(rapidity[i]/ybeam)<ycut1){
	    if(rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2)cth_3_b_ycut1_ptcut1_all_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_pip_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-211 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_pim_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_kp_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==-321 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_km_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_pr_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut1_deut_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)eps_x_b_ycut1_ptcut1_pr_h->Fill(b_impact*b_impact,rsq1*cth3*eta[i]/abs(eta[i])); 
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  eps_y_b_ycut1_ptcut1_pr_h->Fill(b_impact*b_impact,rsq1*sth3);
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  rsq_b_ycut1_ptcut1_pr_h->Fill(b_impact*b_impact,rsq1);
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut2_pr_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==6201 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2) cth_3_b_ycut1_ptcut2_deut_h->Fill(b_impact*b_impact,cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)eps_x_b_ycut1_ptcut2_pr_h->Fill(b_impact*b_impact,rsq1*cth3*eta[i]/abs(eta[i]));
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  eps_y_b_ycut1_ptcut2_pr_h->Fill(b_impact*b_impact,rsq1*sth3); 
	    if(part_id[i]==2212 && rapidity[i] > rapiditymincut_2 && rapidity[i] < rapiditymaxcut_2&& rsq1<rsqmax)  rsq_b_ycut1_ptcut2_pr_h->Fill(b_impact*b_impact,rsq1); 
